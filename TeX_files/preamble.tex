%* Fix annoying warning with pagecolor
\DisemulatePackage{crop}

\usepackage{fontspec}
\usepackage[en-US]{datetime2}
\usepackage[hidelinks]{hyperref}
\usepackage{enumitem}

%? Ling stuff
\usepackage[nostandards]{baabbrevs}
\usepackage[2level]{baarux}
\usepackage{tikzvowel, phonrule}
\baaruset{tr.markup=\transtext, preamble.markup=\bfseries}
\newbaarulinetype{preamble}{pronunciation}{\phontext}
\newcommand{\baaruref}[1]{(\ref{#1})}

\addbaaruhook{everyexesi}{\setlength{\topsep}{0pt}\footnotesize}
\setbaaruabbrevseps{.:-()<>[]}
\baabbrev{abs}{absolutive case}
\baabbrev{erg}{ergative case}
\baabbrev{sg}{singular}
\baabbrev{pl}{plural}

%? Date handling
\DTMsavedate{startdate}{2020-03-15}

%? Layout
\setcounter{chapter}{-1}

%* Phonetic rules spacing
\let\origphonc\phonc
\def\phonc{\setlength{\tabcolsep}{3pt}\origphonc}
\let\origphon\phon
\def\phon{\setlength{\tabcolsep}{3pt}\origphon}

%* Page numbering
\pagestyle{ruled}
\makeevenfoot{ruled}{\thepage}{}{}
\makeoddfoot{ruled}{}{}{\thepage}
\makeevenfoot{plain}{\thepage}{}{}
\makeoddfoot{plain}{}{}{\thepage}

%* Paragraph spacing
\setlength{\parindent}{0pt}
\nonzeroparskip

%* Font
\setmainfont{Libertinus Serif}
\urlstyle{same}

%* ToC styling
\renewcommand\cftdotsep{2.5}

%* Margin notes
\setlrmarginsandblock{3cm}{6cm}{*}
\setlength{\marginparsep}{2em}
\setlength{\marginparpush}{1em}

\checkandfixthelayout

%* Lists
\setlist{topsep=0em, itemsep=.125em}
\setlist[itemize]{label=---}

%? Shortcuts
\newcommand{\langname}{Ahale}
\newcommand{\phontext}[1]{[#1]}
\newcommand{\phomtext}[1]{/#1/}
\newcommand{\morphtext}[1]{|#1|}
\newcommand{\orthotext}[1]{\textlangle #1\textrangle}
\newcommand{\nativetext}[1]{\textit{#1}}
\newcommand{\transtext}[1]{`#1'}
\newcommand{\notabletext}[1]{\textbf{#1}}

\newcommand{\aside}[1]{\marginpar{\strictpagecheck\checkoddpage \ifoddpage\raggedright \else \raggedleft\fi \footnotesize #1}}
\newcommand{\fleuron}{‚ùß}
\newcommand{\allo}{\textasciitilde}